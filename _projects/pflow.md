---
title: "P-Flow: A Fast and Data-Efficient Zero-Shot TTS through Speech Prompting"
collection: projects
author: Sungwon Kim, Kevin J. Shih, Rohan Badlani, João Felipe Santos, Evelina Bhakturina, Mikyas Desta, Rafael Valle, Sungroh Yoon, Bryan Catanzaro
excerpt: "P-Flow is a fast and data-efficient zero-shot text-to-speech model that uses speech prompting mechanism for speaker adaptation."
date: 2023-10-24
---

#### Author: Sungwon Kim, Kevin J. Shih, Rohan Badlani, João Felipe Santos, Evelina Bhakturina, Mikyas Desta, Rafael Valle, Sungroh Yoon, Bryan Catanzaro
#### Posted: Sungwon Kim

## Overview

In our latest work, we present P-Flow, a fast and data-efficient zero-shot TTS model that uses speech prompts for speaker adaptation. P-Flow comprises a speech-prompted text encoder for speaker adaptation and a flow matching generative decoder for high-quality and fast speech synthesis. Our speech-prompted text encoder uses speech prompts and text input to generate speaker-conditional text representation. The flow matching generative decoder uses the speaker-conditional output to synthesize high-quality personalized speech significantly faster than in real-time. Unlike the neural codec language models, we specifically train P-Flow on LibriTTS dataset using a continuous mel-representation. Through our training method using continuous speech prompts, P-Flow matches the speaker similarity performance of the large-scale zero-shot TTS models with two orders of magnitude less training data and has more than 20x faster sampling speed. Our results show that P-Flow has better pronunciation and is preferred in human likeness and speaker similarity to its recent state-of-the-art counterparts, thus defining P-Flow as an attractive and desirable alternative.

The following are the key technical highlights of our work:
<ul>
  <li>We propose a speech prompt approach for the non-autoregressive zero-shot TTS model which surpasses the speaker embedding approach and provides in-context learning capabilities for speaker adaptation.</li>
  <li>We propose a flow matching generative model for a high-quality and fast zero-shot TTS that significantly improves the synthesis speed and sample quality compared to the large-scale autoregressive baseline.</li>
  <li>We demonstrate comparable speaker adaptation performance to the large-scale autoregressive baseline using significantly fewer training data and a small transformer-based encoder, highlighting the effectiveness of the proposed speech prompting approach.</li>
  <li>P-Flow achieves an average inference latency of 0.11 seconds on an NVIDIA A100 GPU.</li>
</ul>

#### This work is published at NeurIPS 2023.

The samples below are generated by a version of P-Flow that was trained on a larger amount of data and utilized a larger model architecture than what was presented in the paper. In the samples below we synthesize P-Flow's abstract in English with different reference voices from our first and last authors.

<table border="0" width="33%" style="font-size:14px">
    <tr>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">Reference Speaker</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">Reference</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">P-Flow (v1.5)</th>
    </tr>
    <tr>
        <td>Bryan Catanzaro</td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1YfMwSiXwOJzAgYE_3otR-i045Wm8H-jt/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1JjmFc8kBu99WgczZdXStxefn98gUNLN2/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr>
        <td>Sungwon Kim</td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1WpYk8Z8UfojrzvU3JmBSqjhjInbXIcKy/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1BI4zhKTFJP8yXRbtYjUAYw9kZXdulFyu/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr>
        <td>Sungwon Kim</td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1kAzjnaHkNQEVasKCUYVSFoqq4xKL-McA/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1j0k085PQNnAHVJbn2NeYHpQjk24jOGd_/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr>
        <td>Sungwon Kim</td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1KsH8jJxSPsK5QgQ4uxRY_YOKTNPAGxYo/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/13F4OrcIhKp4iBGZVTFVzNGUVRevevKqL/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr>
        <td>Sungwon Kim</td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1_AK-ifgR875G8bTsnquVQRzM0yahYXSO/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1w5PRHg1Thn9ofsmqrIgvypJwxrcwRWq-/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr>
        <td>Sungwon Kim</td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1c34IqkzZ6c50KXByftpevpeqYb1WMkc7/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/11m65ZfpFoHk8_R6tJ5j0p5uLp0rI2BlO/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
</table>
<p></p>


## Method
In this work, we aim to provide in-context learning capabilities for zero-shot speaker adaptation in a high-quality and fast non-autoregressive TTS model. To avoid the potential bottleneck of speaker embedding approaches to extract speaker information from the reference speech, we adopt a speech prompting approach that directly utilizes the reference speech as a prompt for speaker adaptation, similar to neural codec language models.

Given a <text, speech> paired data, P-Flow trains in a manner similar to a masked autoencoder, using a 3-second random segment of the speech data and the text input for generative modeling on the remaining segment. During zero-shot inference, P-Flow performs zero-shot TTS by providing a 3-second reference speech of the desired speaker as a prompt. P-Flow has the advantage of executing zero-shot TTS using only audio as a prompt, without the need for a transcript of the reference speech.

![pflow_prompt](images/pflow/pflow-prompt.png)

In P-Flow, we provide the text encoder with a mel-spectrogram of a 3-second reference speech as a speech prompt, along with the text input, to output a text representation for the reference speech. Additionally, we employ a new type of generative model, the flow-matching model, as a decoder for fast and high-quality speech synthesis.

* Speech prompted text encoder for speaker adaptation
* Flow matching generative model for fast and high-quality speech synthesis

![pflow_arch](images/pflow/pflow-architecture.png)


## Audio Samples

### Section 4.1 - Prompting v.s. Separate Speaker Encoder 

This result demonstrates the effectiveness of speaker conditioning through speech prompting. For the baseline (= P-Flow w/o Prompt), instead of directly inputting the speech prompt into the text encoder, we encode a random segment of speech to a fixed-size speaker embedding using a speaker encoder with the same architecture as the text encoder. The table below shows that even without changing other aspects, the use of speech prompts leads to a substantial enhancement in speaker similarity.

* P-Flow: Use Speech-prompted text encoder
* P-Flow (w/o Prompt): Use a fixed-size speaker embedding from a transformer-based speech encoder

![pflow_table1](images/pflow/pflow-table1.png)

[text1]: ## "They moved thereafter cautiously about the hut, groping before and about them to find something to show that Warrenton had fulfilled his mission."
[text2]: ## "Yea, his honourable worship is within. But he hath a godly minister or two with him, and likewise a leech."
[text3]: ## "The army found the people in poverty and left them in comparative wealth."
[text4]: ## "He was in deep converse with the clerk, and entered the hall holding him by the arm." 


<table border="0" width="33%" style="font-size:14px">
    <tr>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">Reference</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">P-Flow</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">P-Flow (w/o Prompt)</th>
    </tr>
    <tr><td colspan=3>They moved thereafter cautiously about the hut, groping before and about them to find something to show that Warrenton had fulfilled his mission.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1bVAyXGm8ZPnrXP0ynOAuX6PnAfmG61f7/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1DLymJ2p6tN-BoLPiUOABeo05D4lR63Sd/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1rsgWzr6kAZ6g8OAlZvEEmmlqVi147OFv/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=3>Yea, his honourable worship is within. But he hath a godly minister or two with him, and likewise a leech.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1FWEBvgLJc26oPhxuRUoHN2L_8l9H-Y2_/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1SlDLi0GbrYjOph27LwtqMmWu7-Wr9S0J/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1NPfGTpk5bElcjlunAtJQ5XcLK4niFt31/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=3>The army found the people in poverty and left them in comparative wealth.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1mEkzFHpiW39asa_CmU6VUTqck3i0MA4R/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1HF2MfvY98geSgJQT_OnpMtvvdIQfQaB7/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1K2rhI0DInNHuAfEOgsR10vg7ApXXm8lc/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=3>He was in deep converse with the clerk, and entered the hall holding him by the arm.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1dBQBiiyt0pDtqsK5O4s082WkZFH9q4kL/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1a6e00bQdIPRDKDAgZnsIgvoAAJlGX-ZC/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1apk0E0Ua2PBSPkFAw1xo4qS5-MRC_B51/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
</table>
<p></p>



### Section 4.2 - Model Comparison (LibriSpeech)

We compare P-Flow with state-of-the-art zero-shot TTS model, VALL-E. Although P-Flow is trained on significantly less amount of training data than VALL-E, P-Flow achieves better WER (ASR metric), comparable SECS (Speaker similarity metric), and 20 times faster sampling speed. 

* Baseline: VALL-E

![pflow_table2](images/pflow/pflow-table2.png)

<table border="0" width="33%" style="font-size:14px">
    <tr>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">Ground Truth</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">Reference</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">P-Flow</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">VALL-E</th>
    </tr>
    <tr><td colspan=4>They moved thereafter cautiously about the hut, groping before and about them to find something to show that Warrenton had fulfilled his mission.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1yFFL3rB1IQxmuHMjyrxCJSu-L1mkZRO_/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1KB5tSd2haykbRgyfOATLXcfzqda8TT1x/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1ydKPO-XAglnQ4erAZwHSVlkWp0Omc8kS/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1x5ufDQQvyGcssGSOf75niK9RsNIsnHyQ/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>And lay me down in thy cold bed, and leave my shining lot.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1xuVOAxYlUQAPmo6M5QtcUDzaFP4sfHbG/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1yMwsjKJGxm7g3tZ209WgONeF18GexeYI/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1mMjkfdNJ86N1DpIuiK4ZOGnYxLP5WTNk/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1YEQxHmjTbR4jLhLTWkutfjqWBQ_EC5SS/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>Yea, his honourable worship is within. But he hath a godly minister or two with him, and likewise a leech.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1GQYiIRTjCc2MQWkWJtNgu2GPzaR5rN6-/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1aV-hOyQF46jGrqIm-vJPEbvHYVTRUecv/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/10RFKGgM5PdBunitljT42v_0ro8fof-L3/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1ntsqAn1vA5OsLGzedRfwXrz16KhRfAiD/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>Instead of shoes, the old man wore boots with turnover tops, and his blue coat had wide cuffs of gold braid.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1nnwp4sL3dHBPjQsgkyca19rF2CS-KtYR/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1lK-AAT0X-0J2tNXeSrtmnPsSe01nkbWr/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1yWxLAerpRpnouXKzZQuGRLw1md2I2vei/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1UC6HbJ_e8bxttTUFVWQAbLPAYsNu54mc/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>The army found the people in poverty and left them in comparative wealth.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1GPk8r5XuIZ2_p65S0cA4_dC6fKO7hak7/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1qQDq2Ib6_h_jWVubRoUrYXFdW5HaCZ9o/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1HIPJGohhj-hOFdLP9Q3yz_SZuUierTXy/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1z1PLKSw4DDMKgJUBOodF2JlMcokyHgD3/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>Thus did this humane and right-minded father comfort his unhappy daughter; and her mother, embracing her again, did all she could to soothe her feelings.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1h7TkFkA64pocFshG_spIf_qwDmhYjYA9/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1y0PxzBYgM1C57BNC6YcStbceaUUqeItw/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1Y38cqBDCsl9elzNckCvrR-hBb08Z0je2/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1vcDJehRppwjWFtLPWSlddtjdrVKsVuuG/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>He was in deep converse with the clerk, and entered the hall holding him by the arm.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1kyDYlritFsEXcAP7QRBtg6Ic8mmAawzG/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1twtZFB8oattpv9PoWumyYAVyRdbDtZZc/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1GfTbj67bGi7voLJQMh9UPgJjU5BNZg_1/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1XUkokrIOZ3YDx7HLk8bbRuaekc-wyu89/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
</table>
<p></p>


### Appendix - Model Comparison (VCTK)

We further compare the P-Flow model with the baseline VALL-E model on a subset of the VCTK dataset samples. Despite being trained on significantly less data compared to VALL-E, P-Flow demonstrates good speaker adaptation performance on the out-of-distribution VCTK dataset.

<table border="0" width="33%" style="font-size:14px">
    <tr>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">Ground Truth</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">Reference</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">P-Flow</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">VALL-E</th>
    </tr>
    <tr><td colspan=4>We have to reduce the number of plastic bags.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1jgIuJvVdSc1h0wU4J6SNgLrJBRvPxTXA/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1T4SDUrLdP6gpG9U0YV8HOUT6ruwL5_YQ/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1KRccMLveD04y0yu7irQNAP7jpiBj46BQ/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1WX031tyZpge2NAOA8y9stpzUjmnbTISH/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>So what is the campaign about?</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1peaaj2QZnqLNNjOggze2C2NMdZyUWZb2/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1bmoTIaIvR0169MW2ZWlHL8v3S6oW24gS/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/10EwIWLsC4bnldetoF1JMd-_pT3xnCcoV/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1zlazdA8sokiXSqRkHALiX-SUq1lj3EWE/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>My life has changed a lot.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1ihnfP7w0To6VPF4sezgAopep7agRKEF3/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1W16YNtHXVG7KCy1OSHyO6Xs0_ckvsAq7/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1JHLyrtG-wnEjTNf7u3vw72J0YzvBq_7p/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1kXFhJH61FLb-UluO_KqIDBhBRZ7OJFFl/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>Nothing is yet confirmed.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/17zTzqg3bvxNn7oCwAv1EuAzF-QnwcFGV/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1LNzm9fUIXsXZUYlJFlv3idr5vyWXfsDU/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/16-WbioJcWhRCrV7jtBNB_rvuAI-w8fF3/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/15yuFySSJpjbrOZRr41RuEtI49h1FYber/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>I could hardly move for the next couple of days.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1GE8OpzTEmqMNHSL_3ZmGNit3K_Nq9CZ5/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/185Vw7nyL-8NgiuIgbh-JU47lM3zeK-9o/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1emoFjkwapOMTOkVcqoAEhpakU2v650LY/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1yg4d3vasT6yVjuVwI_cmUxFqSvz6gggn/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>His son has been travelling with the Tartan Army for years.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1WxPTmeuSXjexrcC99GDxQmwhZxV9sX9t/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1koOoYrjCypUpq2DAPk7OqNWK3xF8jkx9/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1fJD4zjha7d4HmG5KYnW_sdlhzu7zmmmx/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1iU1K0GNloXFNsdcM8Cur0JRm_ssFFhSB/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>Her husband was very concerned that it might be fatal.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1Czn_I59235VbwNLLOewWKIbhoMlf-Jbu/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1vj3xfy4ZnChjPtyU9XlQhjghEYfPvlsl/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1IVBS9xYFuK-m3Az5TOyPu8_jptJuhI8K/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1VUvJBI0rES5-LdbvruZy5lVnD99XAVGT/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>We’ve made a couple of albums.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1ZKYqwzzE4cW6ngpA9Axx_sufYgfq8CG3/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1xnDn0kuLfti88NuSFul9utarECjsnpPc/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1denrH2bf7VN3dk_PIbdJBS-RedxrxfmG/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1j61V1JL6BhCW4Vrz636m6KjzNbTTK9fM/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
</table>
<p></p>



### Section 4.3 - Effect of Guidance Scale and Euler Steps

#### Effect of Guidance Scale (Gamma=Guidance Scale, N=10)

<table border="0" width="33%" style="font-size:14px">
    <tr>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">Reference</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">P-Flow (Gamma=0)</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">P-Flow (Gamma=1)</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">P-Flow (Gamma=2)</th>
    </tr>
    <tr><td colspan=4>They moved thereafter cautiously about the hut, groping before and about them to find something to show that Warrenton had fulfilled his mission.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1UARiwKCrgxNJAAn77Dz375wxkgDovNvd/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1bVH3eCeDYbeaSoVKgXN-Ko6bek0X5bSb/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1xqy_d9BKk4Fx-r-L7X-GivY8gLLx3862/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1CIx2To-z5N81krxL_lB8Y_dhYPA-usMo/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>Yea, his honourable worship is within. But he hath a godly minister or two with him, and likewise a leech.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1s-x5wciUb52DKG6pRdlFwYGLnMvOsiZO/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1WgCzLijkMIg0DqJZJjGWxhQ1macz0Z8k/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/17tqX91-qOtE_mVSQdR0hSNjLH7h4egz6/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/163pBulrZq2ptQoVCTk4AvPleueF2QRq2/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>The army found the people in poverty and left them in comparative wealth.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1LNTjFjC1T8Up8FaDX7M7v2GrtdO04t19/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/14wCzk9j-v-GOal98PoyLMkxqVPO9r75y/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1FPTFRH2jVtbF7XC-3Li6b1YII38-ITT4/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/15948BYZjF6qUPzH4QU5C9D0A2nzy5zSH/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=4>He was in deep converse with the clerk, and entered the hall holding him by the arm.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1Oix94loBL57mUu65LIhe5OSe_I5xt193/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/17pFsJbd9gezjLL3D-clbeQyMo7emz1Gd/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1LmPwMzkJb3BrLmMArYdZ9NmTzC5zCqa4/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1L2kyp0WHIlSyJ4N9g-kLDmvjQLsm7VE-/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
</table>
<p></p>

#### Effect of Sampling Steps (N=Sampling Steps, Gamma=1)

<table border="0" width="33%" style="font-size:14px">
    <tr>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">Reference</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">P-Flow (N=1)</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">P-Flow (N=2)</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">P-Flow (N=5)</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">P-Flow (N=10)</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">P-Flow (N=20)</th>
    </tr>
    <tr><td colspan=6>They moved thereafter cautiously about the hut, groping before and about them to find something to show that Warrenton had fulfilled his mission.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1NIk6zDi38YoXwbcxoIec6GK_shP2HRGt/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1MMWpHU7mQFzsA1p1O_-20INrdVPZKsPr/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/16hkOKDFINp9bcu0Y_0EAalvk2B53t-g8/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1CONzDLtvxBJryQxRuye-C9tjY1Rat2kY/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/150di6ecz3HRqmfiVWZx_-kyI-CB919pg/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1-KT8zNoYrvKfQ7xGTfLU6kqWXeg0Up_b/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=6>Yea, his honourable worship is within. But he hath a godly minister or two with him, and likewise a leech.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1BZ6rVOOm9GshFHowJd0y6e7eH67BGXiA/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/18Ny-WLPaY8z_Dpkf_xfV8skHiRR_QWZa/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1ISx1cANIZdOX4aDDRE0NjTychB4qfZg1/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1imLVx105zCM7VBTovljN9eAL1EW8P372/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1PD4GhPPspMBDUWgeXu0VWs9kn7BLhjSJ/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1LIOYS3S9BgDGUn2KBPh9Q9hsOSppPcvP/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=6>The army found the people in poverty and left them in comparative wealth.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1UKL6JEtifS0TX_C5TYtBlQDWJ9-gY6fv/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1T8W6i6udpg38J47uRlIMF3x_0yBg81gM/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1UDdvk9FqFHZvxL0BJjv0L_pTsvtwbWuc/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/137xyD8Ed8kbjqtg4w1TAkmIazDes2qEF/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1WOf4WScJyiimK4Ot3jK1dSG0oIG0xQqG/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1TB6kiAnxa_bhsSvzckiDy8VZ0x2xaY1W/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr><td colspan=6>He was in deep converse with the clerk, and entered the hall holding him by the arm.</td></tr>
    <tr>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1t1iFL5B0RJ83tN1idDO9ijJf2eZKDz9r/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1-FArOXNMmQnuox0H-lFT0wretS6ujc_s/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/16v6TMjnD3ZSaDiqb-ONU_duOjAnwaq6N/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1iJZdQD3SVIcAzNoIjJKzqzO1p3iadG02/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1iau41zJKlcuDd1S8x3_MM01TYM1OhyGj/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1BX44_l5DO82n1Qq9NieQon8pMTTU_2lw/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
</table>
<p></p>


### Appendix - Zero-shot TTS with Emotional Reference Speech

Text: We have to reduce the number of plastic bags.

<table border="0" width="33%" style="font-size:14px">
    <tr>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">Emotion</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">Reference</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">P-Flow</th>
        <th bgcolor="#3cb371" style="white-space:nowrap;height:30px;min-width: 40px">VALL-E</th>
    </tr>
    <tr>
        <td>Anger</td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1KiG3dt6aLPvHGtBuW4YTYlkd4I3TOKDz/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1YBGG3AYdpwxhwdhbcKeYMp9IVgR-dkjz/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1LO_kietqrjmlJ4IYyjfp_LSvsZxY5SP2/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr>
        <td>Sleepiness</td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1DTQ9fmBL3yVVRP3GZxYbBm0M_dp3dXyM/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1uy3TefrpDyq1oE2M7aLrPMmmPwrb3Ga3/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1Z2bkCaT465jyd7VGt_8CO-E-yqWTpLHR/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr>
        <td>Neutral</td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1I_PgqeUBps2EJTQ1k7sbXZoX1HNIEOgx/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1-vu3YsvC_KYnuDZYDMB6uppa-ZJH4dkl/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1Mn2Ow0iy2OCmOfqoJrWFG4urFHLYErNr/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr>
        <td>Amused</td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1azxIGFVIIt3nEnf6R4ZqqzR74AtZrz7g/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1-1mSiXrypSwTiCEq1OYH6hj1N6sUON5w/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1EJW9uHlkoYE4tWO6xT0Gti90Sg5A56x3/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
    <tr>
        <td>Disgust</td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/15y5rZtTCAFCvFMSnQUgqtNNIaOxWE3mc/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1kKV0ZRCibg354yjZyFFHrsa0z1jw1rly/view?usp=drive_link" type="audio/mpeg"></audio></td>
        <td><audio controls preload="none" style="height:30px"><source src="https://drive.google.com/file/d/1WhrN2GO2-RLxX1JVDLSj1Xj89c34UYO6/view?usp=drive_link" type="audio/mpeg"></audio></td>
    </tr>
</table>
<p></p>